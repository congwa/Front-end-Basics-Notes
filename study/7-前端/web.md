# web

## 性能优化

### 请求和响应优化

> 更快的到达时间

#### 核心思想

- 更好的连接传输效率
- 更少的请求资源数量
- 更小的资源大小
- 合适的缓存策略
  
#### 最佳实践

- 减少DNS查找: 每次主机名的解析都需要一次网络往返，从而增加了请求的延迟时间，同时还会阻塞后续的请求
  
  ```html
  <link rel="dns-prefetch" href="//blog.poetries.top">  
  ```

- 重用tcp连接: 尽可能的使用持久连接，以消除因 TCP 握手和慢启动的延迟
- 减少http重定向 : HTTP重定向需要额外的 DNS 查询、TCP 握手等非常耗时，最佳的重定向次数为0
- 压缩传输的资源：比如Gzip、图片压缩
- 使用缓存：比如HTTP缓存、CDN缓存、Service Worker缓存
- 使用CDN（内容分发网络）：把数据放在离用户地理位置更近的地方，可以明显减少每次 TCP 连接的网络延迟，增大吞吐量
- 删除没必要请求的资源
- 在客户端缓存资源：缓存必要的应用资源，避免每次都重复请求相同的内容，例如多图片下载可以考虑使用缓存
- 内容在传输前先压缩：传输数据前应该先压缩应用资源，把传输的字节减少到最小，在压缩的时候确保对每种不同的资源采用最好的压缩手段
- 消除不必要的请求开销：减少请求的 HTTP 首部数据（比如 HTTP Cookie）
- 并行处理请求和响应：请求和响应的派对都会导致延迟，可以尝试并行的处理请求和响应（利用多个HTTP1.1连接并行下载，在可能的情况下使用 HTTP 管道计数）
- 针对协议版本采取优化措施：升级到 HTTP2.0
- 根据需要采用服务端渲染方式：这种方式可以解决SPA首屏渲染慢的问题
- 采用预渲染的方式快速加载静态页面：页面渲染的极致性能，比较适合静态页面
  
### 渲染优化

> 关键路径优化

- 优化dom
  - 缩小文件的尺寸（Minify）
  - 使用gzip压缩（Compress）
  - 使用缓存（HTTP Cache）
- 优化cssom
  - 非关键CSS资源不阻塞渲染
  - 避免使用@import (串行下载)
  - 优化 JavaScript 的使用
    - 缩小文件的尺寸（Minify）、使用gzip压缩（Compress）、使用缓存（HTTP Cache）
    - 使用 defer 延迟加载JavaScript（并行下载js脚本，但是会按顺序执行）
    - 使用 async 延迟加载JavaScript（并行下载js脚本，谁先加载完谁先执行）
    - 使用WEB Worker（避免运行时间过长的JavaScript）
    - js代码层面的优化 (采用事件委托,减少声明及语句数,减少循环体活动,字面量与构造式,减少数据读取次数,减少作用域链查找层级（空间换时间，时间换空间）,减少作用域链查找层级 （使用return替换if else if）)
  - 
- 优化js的使用

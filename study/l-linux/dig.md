# dig

dig 是 域名查询工具

dig 是一个灵活的 DNS 查询工具，它会打印出 DNS 域名服务器的回应，主要用来从 DNS 域名服务器查询主机地址信息。

dig 命令与 nslookup 命令功能基本相同，但是 dig 命令灵活性好、易用、输出清晰。


```sh
# dig [@server] name type
dig www.baidu.com
```

- name 为要查找的资源记录的名称。
- type 指示所需的查询类型 ANY、A、MX、SIG 等。类型可以是任何有效的查询类型。如果没有提供类型参数，dig 将查找 A 记录。




当然可以，以下是您提供的信息整理成的Markdown表格：

| 选项           | 描述                                                                                                                   |
| -------------- | ---------------------------------------------------------------------------------------------------------------------- |
| @              | 指定进行域名解析的域名服务器。                                                                                          |
| -b \<address>[#\<port>] | 使用指定的本机 IP 地址向域名服务器发送域名查询请求。                                                                      |
| -c \<class>    | 缺省查询类（IN for internet）由选项 -c 重设。class 能够是任何合法类，比如查询 Hesiod 记录的 HS 类或查询 CHAOSNET 记录的 CH 类。     |
| -f \<file>     | 指定 dig 以批处理的方式运行，文件中保存着需要批处理查询的 DNS 任务信息。                                                 |
| -k \<keyfile>  | 要签署由 dig 发送的 DNS 查询连同对他们使用事务签名（TSIG）的响应，用选项 -k 指定 TSIG 密钥文档。                           |
| -p \<port>     | 指定域名服务器所使用端口号。                                                                                            |
| -t \<type>     | 指定要查询的 DNS 数据类型（默认为 A）。                                                                                |
| -x \<addr>     | 执行逆向域名查询。                                                                                                    |
| -4             | 使用 ipv4（默认）。                                                                                                   |
| -6             | 使用 ipv6。                                                                                                           |
| -h             | 显示命令帮助信息。                                                                                                    |
| -y [hmac:]name:key | 通过命令行上的 -y 选项指定 TSIG 密钥；name 是 TSIG 密码的名称，key 是实际的密码。密码是 64 位加密字符串，通常由 dnssec-keygen（8）生成。 |


查询选项

```sh
+[no]tcp
    查询域名服务器时使用 [不使用] TCP。缺省行为是使用 UDP，除非是 AXFR 或 IXFR 请求，才使用 TCP 连接。
+[no]vc
    查询名称服务器时使用 [不使用] TCP。+[no]tcp 的备用语法提供了向下兼容。 vc 代表虚电路。
+[no]ignore
    忽略 UDP 响应的中断，而不是用 TCP 重试。缺省情况运行 TCP 重试。
+domain=somename
    设定包含单个域 somename 的搜索列表，似乎被 /etc/resolv.conf 中的域伪指令指定，并且启用搜索列表处理，似乎给定了 +search 选项。
+[no]search
    使用 [不使用] 搜索列表或 resolv.conf 中的域伪指令（假如有的话）定义的搜索列表。缺省情况不使用搜索列表。
+[no]defname
    不建议看作 +[no]search 的同义词。
+[no]aaonly
    该选项不做任何事。他用来提供对配置成未实现解析器标志的 dig 的旧版本的兼容性。
+[no]adflag
    在查询中配置 [不配置] AD（真实数据）位。现在 AD 位只在响应中有标准含义，而查询中没有，但是出于完整性考虑在查询中这种性能能够配置。
+[no]cdflag
    在查询中配置 [不配置] CD（检查禁用）位。他请求服务器不运行响应信息的 DNSSEC 合法性。
+[no]recursive
    转换查询中的 RD（需要递归）位配置。在缺省情况下配置该位，也就是说 dig 正常情形下发送递归查询。当使用查询选项 +nssearch 或 +trace 时，递归自动禁用。
+[no]nssearch
    这个选项被配置时，dig 试图寻找包含待搜名称的网段的权威域名服务器，并显示网段中每台域名服务器的 SOA 记录。
+[no]trace
    转换为待查询名称从根名称服务器开始的代理路径跟踪。缺省情况不使用跟踪。一旦启用跟踪，dig 使用迭代查询解析待查询名称。他将按照从根服务器的参照，显示来自每台使用解析查询的服务器的应答。
+[no]cmd
    设定在输出中显示指出 dig 版本及其所用的查询选项的初始注释。缺省情况下显示注释。
+[no]short
    提供简要答复。缺省值是以冗长格式显示答复信息。
+[no]identify
    当启用 +short 选项时，显示 [或不显示] 提供给答的 IP 地址和端口号。假如请求简短格式应答，缺省情况不显示提供给答的服务器的源地址和端口号。
+[no]comments
    转换输出中的注释行显示。缺省值是显示注释。
+[no]stats
    该查询选项设定显示统计信息：查询进行时，应答的大小等等。缺省显示查询统计信息。
+[no]qr
    显示 [不显示] 发送的查询请求。缺省不显示。
+[no]question
    当返回应答时，显示 [不显示] 查询请求的问题部分。缺省作为注释显示问题部分。
+[no]answer
    显示 [不显示] 应答的回答部分。缺省显示。
+[no]authority
    显示 [不显示] 应答的权限部分。缺省显示。
+[no]additional
    显示 [不显示] 应答的附加部分。缺省显示。
+[no]all
    配置或清除任何显示标志。
+time=T
    为查询配置超时时间为 T 秒。缺省是5秒。假如将 T 配置为小于1的数，则以1秒作为查询超时时间。
+tries=A
    配置向服务器发送 UDP 查询请求的重试次数为 A，代替缺省的 3 次。假如把 A 小于或等于 0，则采用 1 为重试次数。
+ndots=D
    出于完全考虑，配置必须出现在名称 D 的点数。缺省值是使用在 /etc/resolv.conf 中的 ndots 语句定义的，或是 1，假如没有 ndots 语句的话。带更少点数的名称被解释为相对名称，并通过搜索列表中的域或文档 /etc/resolv.conf 中的域伪指令进行搜索。
+bufsize=B
    配置使用 EDNS0 的 UDP 消息缓冲区大小为 B 字节。缓冲区的最大值和最小值分别为 65535 和 0。超出这个范围的值自动舍入到最近的有效值。
+[no]multiline
    以周详的多行格式显示类似 SOA 的记录，并附带可读注释。缺省值是每单个行上显示一条记录，以便于电脑解析 dig 的输出。
```


## 常用示例

```sh
dig www.baidu.com

# 对目标 IP 进行反向解析查询。
dig -x 110.242.68.4

# 查询目标域名的 MX 记录
dig -t MX www.baidu.com

# 查询目标域名的 A 记录
dig www.baidu.com A

# 需要快速响应时，+short。
dig www.baidu.com +short

# 查询指定域名的 AAAA 记录。

dig www.baidu.com AAAA +short

# 指定域名服务器进行查询
dig @ns1.google.com www.google.com

# 跟踪 dig 查询的路径
dig www.baidu.com +trace

# 获取 SOA 记录
dig baidu.com +nssearch

```